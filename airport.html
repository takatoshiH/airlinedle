<html>
<head>
	<link rel="stylesheet" href="airdle.css">
</head>
<h1 style="text-align: center">Airdle</h1>
<h3 style="text-align: center">国内空港の3レターを入れよう！</h3>
<h4 style="text-align: center"><a href="https://www.nytimes.com/games/wordle/index.html" target="_blank">ルールはこちらを参考に</a></h4>
<div style="text-align: center;">
	<div class="record">
		<input id="1_1" maxlength="1" class="input">
		<input id="1_2" maxlength="1" class="input">
		<input id="1_3" maxlength="1" class="input">
		<button id="1_submit">決定</button>
	</div>
	<div class="record">
		<input id="2_1" maxlength="1" disabled class="input">
		<input id="2_2" maxlength="1" disabled class="input">
		<input id="2_3" maxlength="1" disabled class="input">
		<button id="2_submit" disabled>決定</button>
	</div>
	<div class="record">
		<input id="3_1" maxlength="1" disabled class="input">
		<input id="3_2" maxlength="1" disabled class="input">
		<input id="3_3" maxlength="1" disabled class="input">
		<button id="3_submit" disabled>決定</button>
	</div>
	<div class="record">
		<input id="4_1" maxlength="1" disabled class="input">
		<input id="4_2" maxlength="1" disabled class="input">
		<input id="4_3" maxlength="1" disabled class="input">
		<button id="4_submit" disabled>決定</button>
	</div>
	<div class="record">
		<input id="5_1" maxlength="1" disabled class="input">
		<input id="5_2" maxlength="1" disabled class="input">
		<input id="5_3" maxlength="1" disabled class="input">
		<button id="5_submit" disabled>決定</button>
	</div>
	<div class="record">
		<input id="6_1" maxlength="1" disabled class="input">
		<input id="6_2" maxlength="1" disabled class="input">
		<input id="6_3" maxlength="1" disabled class="input">
		<button id="6_submit" disabled>決定</button>
	</div>
	<div class="record">
		<input id="7_1" maxlength="1" disabled class="input">
		<input id="7_2" maxlength="1" disabled class="input">
		<input id="7_3" maxlength="1" disabled class="input">
		<button id="7_submit" disabled>決定</button>
	</div>

	<!--    正解時のmodal-->
	<div class="popup" id="js-popup">
		<div class="popup-inner">
			<img src="happy.png">
			<button id="next">Next</button>
		</div>
		<div class="black-background" id="js-black-bg"></div>
	</div>

	<!--    不正解時のmodal-->
	<div class="popup" id="js-popup-lose">
		<div class="popup-inner">
			<img src="lose.png">
			<div id="answer-airline"></div>
			<button id="next-lose">Next</button>
		</div>
		<div class="black-background" id="js-black-bg-lose"></div>
	</div>
</html>

<script>
    const airports = ["成田（新東京国際）,NRT",
        "羽田（東京国際）,HND",
        "関西国際,KIX",
        "中部国際,NGO",
        "伊丹（大阪国際）,ITM",
        "新千歳,CTS",
        "仙台,SDJ",
        "福岡,FUK",
        "那覇,OKA",
        "稚内,WKJ",
        "利尻,RIS",
        "紋別,MBE",
        "女満別,MMB",
        "旭川,AKJ",
        "中標津,SHB",
        "釧路,KUH",
        "札幌丘珠,OKD",
        "帯広,OBO",
        "奥尻,OIR",
        "函館,HKD",
        "青森,AOJ",
        "三沢,MIS",
        "大館能代,ONJ",
        "秋田,AXT",
        "花巻,HNA",
        "庄内,SYO",
        "山形,GAJ",
        "福島,FKS",
        "新潟,KIJ",
        "佐渡,SDS",
        "能登,NTQ",
        "富山,TOY",
        "小松,KMQ",
        "松本,MMJ",
        "茨城,IBR",
        "静岡,FSZ",
        "名古屋小牧,NKM",
        "大島,OIM",
        "三宅島,MYE",
        "八丈島,HAC",
        "但馬,TKG",
        "神戸,UKB",
        "南紀白浜,SHM",
        "隠岐,OKI",
        "鳥取,TTJ",
        "米子,YGJ",
        "出雲,IZO",
        "石見,IWJ",
        "岡山,OKJ",
        "広島,HIJ",
        "岩国,IWK",
        "山口宇部,UBJ",
        "高松,TAK",
        "徳島,TKS",
        "松山,MYJ",
        "高知,KCZ",
        "対馬,TSJ",
        "壱岐,IKI",
        "北九州,KKJ",
        "大分,OIT",
        "佐賀,HSG",
        "長崎,NGS",
        "福江,FUJ",
        "熊本,KMJ",
        "天草,AXJ",
        "宮崎,KMI",
        "鹿児島,KOJ",
        "種子島,TNE",
        "屋久島,KUM",
        "奄美大島,ASJ",
        "喜界島,KKX",
        "徳之島,TKN",
        "沖永良部,OKE",
        "与論,RNJ",
        "粟国,AGJ",
        "久米島,UEO",
        "慶良間,KJP",
        "北大東,KTD",
        "南大東,MMD",
        "宮古,MMY",
        "下地島,SHI",
        "多良間,TRA",
        "新石垣,ISG",
        "波照間,HTR",
        "与那国,OGN"
    ];

    airports.forEach((airport) => {
        airport.split(",");
    });

    const answer = airports[Math.floor(Math.random() * (airports.length - 1))];
    const splited_answer = answer.split("");

    console.log(answer);

    // 一列目
    document.getElementById("1_submit").addEventListener("click", () => {
        const recordNumber = 1;
        let [first_input, second_input, third_input, button] = getNeededDoms(recordNumber);

        const first = first_input.value;
        const second = second_input.value;
        const third = third_input.value;
        const airline = first + second + third;

        if(airline === answer) {
            showModal();
            return;
        }

        if(!airlines.includes(airline)) {
            alert("そのような航空会社はありません");
            return;
        }

        let results = [];

        for (let index = 0; index < splited_answer.length; index++) {
            const word = answer[index];
            if(index == 0) results.push(giveResult(word, first));
            if(index == 1) results.push(giveResult(word, second));
            if(index == 2) results.push(giveResult(word, third));
        }

        button.setAttribute("disabled", true);
        first_input.setAttribute("disabled", true);
        second_input.setAttribute("disabled", true);
        third_input.setAttribute("disabled", true);

        for (let index = 0; index < results.length; index++) {
            const result = results[index];
            if(index === 0) giveResultClass(result, first_input);
            if(index === 1) giveResultClass(result, second_input);
            if(index === 2) giveResultClass(result, third_input);
        }

        removeDisabled(2);
    });

    // 二列目
    document.getElementById("2_submit").addEventListener("click", () => {
        const recordNumber = 2;
        let [first_input, second_input, third_input, button] = getNeededDoms(recordNumber);

        const first = first_input.value;
        const second = second_input.value;
        const third =third_input.value;
        const airline = first + second + third;

        //正解の時
        if(airline === answer) {
            showModal();
            return;
        }

        if(!airlines.includes(airline)) {
            alert("そのような航空会社はありません");
            return;
        }

        let results = [];

        for (let index = 0; index < splited_answer.length; index++) {
            const word = answer[index];
            if(index == 0) results.push(giveResult(word, first));
            if(index == 1) results.push(giveResult(word, second));
            if(index == 2) results.push(giveResult(word, third));
        }

        button.setAttribute("disabled", true);
        first_input.setAttribute("disabled", true);
        second_input.setAttribute("disabled", true);
        third_input.setAttribute("disabled", true);

        for (let index = 0; index < results.length; index++) {
            const result = results[index];
            if(index === 0) giveResultClass(result, first_input);
            if(index === 1) giveResultClass(result, second_input);
            if(index === 2) giveResultClass(result, third_input);

        }

        removeDisabled(3);
    });

    // 3列目
    document.getElementById("3_submit").addEventListener("click", () => {
        const recordNumber = 3;
        let [first_input, second_input, third_input, button] = getNeededDoms(recordNumber);

        const first = first_input.value;
        const second = second_input.value;
        const third =third_input.value;
        const airline = first + second + third;

        //正解の時
        if(airline === answer) {
            showModal();
            return;
        }

        if(!airlines.includes(airline)) {
            alert("そのような航空会社はありません");
            return;
        }

        let results = [];

        for (let index = 0; index < splited_answer.length; index++) {
            const word = answer[index];
            if(index == 0) results.push(giveResult(word, first));
            if(index == 1) results.push(giveResult(word, second));
            if(index == 2) results.push(giveResult(word, third));
        }

        button.setAttribute("disabled", true);
        first_input.setAttribute("disabled", true);
        second_input.setAttribute("disabled", true);
        third_input.setAttribute("disabled", true);

        for (let index = 0; index < results.length; index++) {
            const result = results[index];
            if(index === 0) giveResultClass(result, first_input);
            if(index === 1) giveResultClass(result, second_input);
            if(index === 2) giveResultClass(result, third_input);

        }

        removeDisabled(4);
    });

    //4
    document.getElementById("4_submit").addEventListener("click", () => {
        const recordNumber = 4;
        let [first_input, second_input, third_input, button] = getNeededDoms(recordNumber);

        const first = first_input.value;
        const second = second_input.value;
        const third =third_input.value;
        const airline = first + second + third;

        //正解の時
        if(airline === answer) {
            showModal();
            return;
        }

        if(!airlines.includes(airline)) {
            alert("そのような航空会社はありません");
            return;
        }

        let results = [];

        for (let index = 0; index < splited_answer.length; index++) {
            const word = answer[index];
            if(index == 0) results.push(giveResult(word, first));
            if(index == 1) results.push(giveResult(word, second));
            if(index == 2) results.push(giveResult(word, third));
        }

        button.setAttribute("disabled", true);
        first_input.setAttribute("disabled", true);
        second_input.setAttribute("disabled", true);
        third_input.setAttribute("disabled", true);

        for (let index = 0; index < results.length; index++) {
            const result = results[index];
            if(index === 0) giveResultClass(result, first_input);
            if(index === 1) giveResultClass(result, second_input);
            if(index === 2) giveResultClass(result, third_input);

        }

        removeDisabled(5);
    });


    // 5列目
    document.getElementById("5_submit").addEventListener("click", () => {
        const recordNumber = 5;
        let [first_input, second_input, third_input, button] = getNeededDoms(recordNumber);

        const first = first_input.value;
        const second = second_input.value;
        const third =third_input.value;
        const airline = first + second + third;

        //正解の時
        if(airline === answer) {
            showModal();
            return;
        }

        if(!airlines.includes(airline)) {
            alert("そのような航空会社はありません");
            return;
        }

        let results = [];

        for (let index = 0; index < splited_answer.length; index++) {
            const word = answer[index];
            if(index == 0) results.push(giveResult(word, first));
            if(index == 1) results.push(giveResult(word, second));
            if(index == 2) results.push(giveResult(word, third));
        }

        button.setAttribute("disabled", true);
        first_input.setAttribute("disabled", true);
        second_input.setAttribute("disabled", true);
        third_input.setAttribute("disabled", true);

        for (let index = 0; index < results.length; index++) {
            const result = results[index];
            if(index === 0) giveResultClass(result, first_input);
            if(index === 1) giveResultClass(result, second_input);
            if(index === 2) giveResultClass(result, third_input);

        }

        removeDisabled(6);
    });

    // 6列目
    document.getElementById("6_submit").addEventListener("click", () => {
        const recordNumber = 6;
        let [first_input, second_input, third_input, button] = getNeededDoms(recordNumber);

        const first = first_input.value;
        const second = second_input.value;
        const third =third_input.value;
        const airline = first + second + third;

        //正解の時
        if(airline === answer) {
            showModal();
            return;
        }

        if(!airlines.includes(airline)) {
            alert("そのような航空会社はありません");
            return;
        }

        let results = [];

        for (let index = 0; index < splited_answer.length; index++) {
            const word = answer[index];
            if(index == 0) results.push(giveResult(word, first));
            if(index == 1) results.push(giveResult(word, second));
            if(index == 2) results.push(giveResult(word, third));
        }

        button.setAttribute("disabled", true);
        first_input.setAttribute("disabled", true);
        second_input.setAttribute("disabled", true);
        third_input.setAttribute("disabled", true);

        for (let index = 0; index < results.length; index++) {
            const result = results[index];
            if(index === 0) giveResultClass(result, first_input);
            if(index === 1) giveResultClass(result, second_input);
            if(index === 2) giveResultClass(result, third_input);

        }

        removeDisabled(7);
    });

    // 七列目
    document.getElementById("7_submit").addEventListener("click", () => {
        const recordNumber = 7;
        let [first_input, second_input, third_input, button] = getNeededDoms(recordNumber);

        const first = first_input.value;
        const second = second_input.value;
        const third =third_input.value;
        const airline = first + second + third;

        //正解の時
        if(airline === answer) {
            showModal();
            return;
        }

        if(!airlines.includes(airline)) {
            alert("そのような航空会社はありません");
            return;
        }

        let results = [];

        for (let index = 0; index < splited_answer.length; index++) {
            const word = answer[index];
            if(index == 0) results.push(giveResult(word, first));
            if(index == 1) results.push(giveResult(word, second));
            if(index == 2) results.push(giveResult(word, third));
        }

        button.setAttribute("disabled", true);
        first_input.setAttribute("disabled", true);
        second_input.setAttribute("disabled", true);
        third_input.setAttribute("disabled", true);

        for (let index = 0; index < results.length; index++) {
            const result = results[index];
            if(index === 0) giveResultClass(result, first_input);
            if(index === 1) giveResultClass(result, second_input);
            if(index === 2) giveResultClass(result, third_input);
        }
        showModalLose();
    });

    function giveResultClass(result, input) {
        input.classList.add(result);
    }

    function getNeededDoms(index) {
        const first_input = document.getElementById(`${index}_1`);
        const second_input = document.getElementById(`${index}_2`);
        const third_input = document.getElementById(`${index}_3`);
        const button = document.getElementById(`${index}_submit`);

        return [first_input, second_input, third_input, button];
    }

    function removeDisabled(index) {
        document.getElementById(`${index}_submit`).removeAttribute("disabled");
        document.getElementById(`${index}_1`).removeAttribute("disabled");
        document.getElementById(`${index}_2`).removeAttribute("disabled");
        document.getElementById(`${index}_3`).removeAttribute("disabled");
    }

    function giveResult(word, partOfAnswer) {
        if(word === partOfAnswer) {
            return "correct";
        } else if(answer.includes(partOfAnswer)) {
            return "include";
        } else {
            return "wrong";
        }
    }

    function showModal() {
        let popup = document.getElementById('js-popup');
        popup.classList.add('is-show');
        closePopUp(document.getElementById('js-black-bg'));
    }

    function showModalLose() {
        let popup = document.getElementById('js-popup-lose');
        popup.classList.add('is-show');
        document.getElementById("answer-airline").textContent = `正解は${answer}でした`;
        closePopUpLose(document.getElementById('js-black-bg-lose'));
    }

    function closePopUp(elem) {
        if(!elem) return;
        elem.addEventListener('click', function() {
            let popup = document.getElementById('js-popup');
            popup.classList.remove('is-show');
        })
    }

    function closePopUpLose(elem) {
        if(!elem) return;
        elem.addEventListener('click', function() {
            let popup = document.getElementById('js-popup-lose');
            popup.classList.remove('is-show');
        })
    }

    document.getElementById("next").addEventListener("click", () => {
        location.reload();
    });

    document.getElementById("next-lose").addEventListener("click", () => {
        location.reload();
    });

</script>